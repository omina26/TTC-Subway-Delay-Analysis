rmarkdown::render_site()
df = read.csv("merged_data.csv", header = TRUE)
library(dplyr)
library(ggplot2)
library(plotly)
library(dplyr)
library(plotly)
library(leaflet)
install.packages("leaflet")
library(dplyr)
library(plotly)
library(leaflet)
library(DT)
install.packages("DT")
library(dplyr)
library(plotly)
library(leaflet)
library(DT)
leaflet(data = merged_df) %>%
addTiles() %>%
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
color = ~ifelse(delay_type == "Mechanical", "red", "blue"),
popup = ~paste0("Station: ", station, "<br>",
"Delay: ", delay_type, "<br>",
"Time: ", timestamp),
radius = 4,
stroke = FALSE,
fillOpacity = 0.8
)
leaflet(data = df) %>%
addTiles() %>%
addCircleMarkers(
lng = ~longitude,
lat = ~latitude,
color = ~ifelse(delay_type == "Mechanical", "red", "blue"),
popup = ~paste0("Station: ", station, "<br>",
"Delay: ", delay_type, "<br>",
"Time: ", timestamp),
radius = 4,
stroke = FALSE,
fillOpacity = 0.8
)
str(df)
str(coord_df)
df = read.csv("merged_data.csv", header = TRUE)
df = read.csv("merged_data.csv", header = TRUE)
coord_df = read.csv("stations_data.csv", header = TRUE)
str(df)
str(coord_df)
df_map <- df %>%
group_by(cleaned_station) %>%
summarize(delay_count = n(), .groups = "drop") %>%
inner_join(coord_df, by = c("cleaned_station" = "station"))
leaflet(df_map) %>%
addTiles() %>%
addCircleMarkers(
lng = ~longitude, lat = ~latitude,
radius = ~sqrt(delay_count),  # scale size by count
color = "darkred",
stroke = FALSE, fillOpacity = 0.7,
popup = ~paste0("<b>", cleaned_station, "</b><br>Delays: ", delay_count)
)
df_map <- df %>%
group_by(cleaned_station) %>%
summarize(delay_count = n(), .groups = "drop") %>%
inner_join(coord_df, by = c("cleaned_station" = "station"))
delay_map = leaflet(df_map) %>%
addTiles() %>%
addCircleMarkers(
lng = ~longitude, lat = ~latitude,
radius = ~sqrt(delay_count),  # scale size by count
color = "darkred",
stroke = FALSE, fillOpacity = 0.7,
popup = ~paste0("<b>", cleaned_station, "</b><br>Delays: ", delay_count)
)
heat_df <- df %>%
group_by(day, hour) %>%
summarize(delay_count = n(), .groups = "drop")
# Ensure day order (optional)
heat_df$day <- factor(heat_df$day,
levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
plot_ly(heat_df,
x = ~hour,
y = ~day,
z = ~delay_count,
type = "heatmap",
colors = "Reds") %>%
layout(title = "Frequency of Delays by Hour and Day of Week",
xaxis = list(title = "Hour of Day"),
yaxis = list(title = "Day of Week"))
heat_df <- df %>%
group_by(day, hour) %>%
summarize(delay_count = n(), .groups = "drop")
# Ensure day order (optional)
heat_df$day <- factor(heat_df$day,
levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
heat_plot = plot_ly(heat_df,
x = ~hour,
y = ~day,
z = ~delay_count,
type = "heatmap",
colors = "Reds") %>%
layout(title = "Frequency of Delays by Hour and Day of Week",
xaxis = list(title = "Hour of Day"),
yaxis = list(title = "Day of Week"))
df_map <- df %>%
group_by(cleaned_station) %>%
summarize(delay_count = n(), .groups = "drop") %>%
inner_join(coord_df, by = c("cleaned_station" = "station"))
delay_map = leaflet(df_map) %>%
addTiles() %>%
addCircleMarkers(
lng = ~longitude, lat = ~latitude,
radius = ~sqrt(delay_count),  # scale size by count
color = "darkred",
stroke = FALSE, fillOpacity = 0.7,
popup = ~paste0("<b>", cleaned_station, "</b><br>Delays: ", delay_count)
) %>%
addControl(
html = tags$div(
tags$h4("Subway Delay Frequency by Station", style = "margin: 0;")
),
position = "topright"
)
library(dplyr)
library(plotly)
library(leaflet)
library(DT)
library(htmltools)
df_map <- df %>%
group_by(cleaned_station) %>%
summarize(delay_count = n(), .groups = "drop") %>%
inner_join(coord_df, by = c("cleaned_station" = "station"))
delay_map = leaflet(df_map) %>%
addTiles() %>%
addCircleMarkers(
lng = ~longitude, lat = ~latitude,
radius = ~sqrt(delay_count),  # scale size by count
color = "darkred",
stroke = FALSE, fillOpacity = 0.7,
popup = ~paste0("<b>", cleaned_station, "</b><br>Delays: ", delay_count)
) %>%
addControl(
html = tags$div(
tags$h4("Subway Delay Frequency by Station", style = "margin: 0;")
),
position = "topright"
)
